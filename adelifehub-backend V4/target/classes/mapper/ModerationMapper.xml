<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.adlifehub.adlife.mapper.ModerationMapper">
    <resultMap id="NoteMap" type="com.adlifehub.adlife.model.ModerationNote">
        <id column="id" property="id"/>
        <result column="target_type" property="targetType"/>
        <result column="target_id" property="targetId"/>
        <result column="actor_id" property="actorId"/>
        <result column="note" property="note"/>
        <result column="created_at" property="createdAt"/>
    </resultMap>
    <insert id="insert" parameterType="com.adlifehub.adlife.model.ModerationNote"
            useGeneratedKeys="true" keyProperty="id">
        insert into moderation_notes(target_type, target_id, actor_id, note, created_at)
        values (#{targetType}, #{targetId}, #{actorId}, #{note}, #{createdAt})
    </insert>
    <select id="list" resultMap="NoteMap">select *
                                          from moderation_notes
                                          where target_type = #{targetType}
                                            and target_id = #{targetId}
                                          order by created_at desc</select>
</mapper>
